<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>모바일 갤러그</title>
<meta name="description" content="모바일 최적화 한 파일 갤러그. 드래그=이동+사격, 1열 작은 UI, 10단계 보스. 하단 버튼 제거. 보스/적 탄막 패턴 + 무기 아이템" />
<style>
  :root{ --bg:#0b0f19; --panel:#12182A; --accent:#67b8ff; --accent2:#ffd166; --danger:#ff6b6b; --text:#e9ecff; --muted:#9aa5c4; --border:#223057; --shadow:rgba(0,0,0,.35); }
  *{box-sizing:border-box}
  html,body{height:100%;}
  body{margin:0; background:radial-gradient(1200px 600px at 50% -10%, #0f1530 0%, #0b0f19 45%, #090d16 100%); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, "Pretendard","Segoe UI", Roboto, Helvetica, Arial, sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; touch-action:none; overscroll-behavior:none; font-size:12px}
  .wrap{position:relative; width:100%; height:100dvh;}
  canvas{position:fixed; inset:0; width:100%; height:100dvh; display:block;}
  /* HUD 및 Overlay CSS 동일 (생략) */
</style>
</head>
<body>
  <div class="wrap">
    <canvas id="game"></canvas>
    <!-- HUD 및 Overlay HTML 동일 (생략) -->
  </div>
<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const $ = id => document.getElementById(id);
  // (중략: 기존 변수 및 함수 정의 동일)

  function spawnBoss(stage){
    // 보스 HP: 1탄=400, 이후 스테이지마다 150씩 증가
    const hp = 400 + (stage - 1) * 150;
    const size = Math.min(120 + stage*10, 200) * DPR;
    // 보스 속도와 공격 주기도 스테이지별로 강화
    const speed = (40 + stage*10) * DPR;
    boss = { x: playW*0.5 - size*0.5, y: 36*DPR, w: size, h: size*0.6, hp, maxHp: hp, dir: 1, speed, phase: 0, shotTimer: 0, angle: 0 };
    game.inBoss = true; updateBossHud(); beep(200,0.25,0.07); beep(160,0.25,0.06);
  }

  // Boss patterns: ring / spiral / aimed burst / sweep arcs
  function bossShoot(){
    if(!boss) return;
    const s = game.stage;
    const cx = boss.x + boss.w*0.5;
    const cy = boss.y + boss.h*0.5;
    boss.angle += 0.25 + s*0.03; // 각도 회전 속도도 난이도별 증가
    const pick = (s % 4);
    // 보스 탄속 가속 강화 (기존 220 + s*35 → 250 + s*45)
    const speedBase = (250 + s*45) * DPR;
    switch(pick){
      case 1: // spiral
        for(let k=0;k<5;k++){
          const ang = (boss.angle + k*0.5);
          const vx = Math.sin(ang)*speedBase, vy=Math.cos(ang)*speedBase;
          bullets.push({x:cx, y:cy, w:4*DPR, h:10*DPR, vx, vy, owner:'boss'});
        }
        break;
      case 2: // aimed burst
        for(let i=0;i<4+Math.floor(s*0.4);i++){
          const spread = (-0.2 + (i/Math.max(1,3+Math.floor(s*0.4)))*0.4);
          const V = aimVec(cx, cy, player.x, player.y, speedBase);
          const vx = V.vx + Math.sin(spread)*100*DPR; const vy = V.vy + Math.cos(spread)*60*DPR;
          bullets.push({x:cx, y:cy, w:4*DPR, h:10*DPR, vx, vy, owner:'boss'});
        }
        break;
      case 3: // sweep arcs
        for(let a=-0.6;a<=0.6;a+=0.1){
          const ang = a + Math.sin(boss.angle*0.6)*0.5;
          const vx=Math.sin(ang)*speedBase, vy=Math.cos(ang)*speedBase;
          bullets.push({x:cx, y:cy, w:4*DPR, h:10*DPR, vx, vy, owner:'boss'});
        }
        break;
      default: // ring
        const n = 12 + Math.floor(s*0.6);
        for(let i=0;i<n;i++){
          const ang = (i/n)*Math.PI*2;
          const vx=Math.sin(ang)*speedBase, vy=Math.cos(ang)*speedBase;
          bullets.push({x:cx, y:cy, w:4*DPR, h:10*DPR, vx, vy, owner:'boss'});
        }
    }
    beep(180,0.08,0.05);
  }

  // (나머지 전체 로직 동일)
})();
</script>
</body>
</html>